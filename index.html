<!doctype html>
<html lang="en">
  <head>
    <title>Semantic Libebreaker</title>
    <meta charset="utf-8">
    <style>
      html {
        height: 100%;
      }
      body {
        height: -webkit-calc(100% - 2em);
        height: calc(100% - 2em);
      }
      #textbox {
        height: -webkit-calc(100% - 5em);
        height: calc(100% - 5em);
        width: 90%;
        margin-bottom: 1.5em;
        clear: both;
      }
      form {
        text-align: center;
        width: 100%;
        height: -webkit-calc(100% - 4em);
        height: calc(100% - 4em);
      }
    </style>
    <script>
      function capturePaste() { 
        // http://stackoverflow.com/q/2176861/266309
        setTimeout(breakPhrases, 1);
      }
      function breakPhrases() {
        textarea = document.getElementById("textbox");
        // break on conjunctions
        textarea.value = textarea.value.replace(/(.{20,}?) (or|and|but|e(\. ?)?g\.?|i(\. ?)?e\.?) /g, "$1\n$2 ");
        // break on punctuation
        textarea.value = textarea.value.replace(/(.{20,}?)([,.?!][”"]?|[:;]) /g, "$1$2\n");
        // mark too long lines, if there are any left
        textarea.value = textarea.value.replace(/^([^¶\n]{72,}?)(?!¶) /gm, "$1¶ ");
      }
    </script>
  </head>
  <body>
    <p>
      Paste your text below
      to have it automatically formatted
      using <a href="http://rhodesmill.org/brandon/2012/one-sentence-per-line/">
      semantic linebreaks</a>:
    </p>
    <form>
      <textarea id="textbox" onpaste='capturePaste();'></textarea>
      <br>
      <input type="reset" value="clear">
    </form>
  </body>
</html>
